import{B as g,i as o,C as j,D as te,E as se,G as k,H as re,I as ne,d as N,J as ae,K as le,L as oe,M as p,N as ie,O as ce,P as ue,b as u,c as m,r as z,g as K,t as de,f as s,Q as A,F as V,R as B,x as w,e as D,w as fe,S as ve,T as pe,U as me,V as ge,W as ye,X as _,Y as we,Z as he}from"./app-JCmIxXXV.js";import{E as Le}from"./index-CX8Dv_sG.js";const Ee=(r,n)=>{if(!g||!r||!n)return!1;const t=r.getBoundingClientRect();let a;return n instanceof Element?a=n.getBoundingClientRect():a={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<a.bottom&&t.bottom>a.top&&t.right>a.left&&t.left<a.right},Se=["class","style"],be=/^on[A-Z]/,Ie=(r={})=>{const{excludeListeners:n=!1,excludeKeys:t}=r,a=o(()=>((t==null?void 0:t.value)||[]).concat(Se)),d=te();return d?o(()=>{var l;return j(Object.entries((l=d.proxy)==null?void 0:l.$attrs).filter(([f])=>!a.value.includes(f)&&!(n&&be.test(f))))}):o(()=>({}))},F=se({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:k([String,Object])},previewSrcList:{type:k(Array),default:()=>re([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:k(String)}}),Ce={load:r=>r instanceof Event,error:r=>r instanceof Event,switch:r=>ne(r),close:()=>!0,show:()=>!0},ke=N({name:"ElImage",inheritAttrs:!1}),ze=N({...ke,props:F,emits:Ce,setup(r,{emit:n}){const t=r;let a="";const{t:d}=ae(),l=le("image"),f=oe(),O=o(()=>j(Object.entries(f).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),M=Ie({excludeListeners:!0,excludeKeys:o(()=>Object.keys(O.value))}),L=p(),y=p(!1),v=p(!0),E=p(!1),h=p(),c=p(),Y=g&&"loading"in HTMLImageElement.prototype;let S,b;const U=o(()=>[l.e("inner"),I.value&&l.e("preview"),v.value&&l.is("loading")]),W=o(()=>{const{fit:e}=t;return g&&e?{objectFit:e}:{}}),I=o(()=>{const{previewSrcList:e}=t;return Array.isArray(e)&&e.length>0}),X=o(()=>{const{previewSrcList:e,initialIndex:i}=t;let $=i;return i>e.length-1&&($=0),$}),T=o(()=>t.loading==="eager"?!1:!Y&&t.loading==="lazy"||t.lazy),C=()=>{g&&(v.value=!0,y.value=!1,L.value=t.src)};function Z(e){v.value=!1,y.value=!1,n("load",e)}function G(e){v.value=!1,y.value=!0,n("error",e)}function x(){Ee(h.value,c.value)&&(C(),R())}const H=ie(x,200,!0);async function P(){var e;if(!g)return;await pe();const{scrollContainer:i}=t;me(i)?c.value=i:ge(i)&&i!==""?c.value=(e=document.querySelector(i))!=null?e:void 0:h.value&&(c.value=ye(h.value)),c.value&&(S=_(c,"scroll",H),setTimeout(()=>x(),100))}function R(){!g||!c.value||!H||(S==null||S(),c.value=void 0)}function q(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function J(){I.value&&(b=_("wheel",q,{passive:!1}),a=document.body.style.overflow,document.body.style.overflow="hidden",E.value=!0,n("show"))}function Q(){b==null||b(),document.body.style.overflow=a,E.value=!1,n("close")}function ee(e){n("switch",e)}return ce(()=>t.src,()=>{T.value?(v.value=!0,y.value=!1,R(),P()):C()}),ue(()=>{T.value?P():C()}),(e,i)=>(u(),m("div",B({ref_key:"container",ref:h},s(O),{class:[s(l).b(),e.$attrs.class]}),[y.value?z(e.$slots,"error",{key:0},()=>[K("div",{class:A(s(l).e("error"))},de(s(d)("el.image.error")),3)]):(u(),m(V,{key:1},[L.value!==void 0?(u(),m("img",B({key:0},s(M),{src:L.value,loading:e.loading,style:s(W),class:s(U),crossorigin:e.crossorigin,onClick:J,onLoad:Z,onError:G}),null,16,["src","loading","crossorigin"])):w("v-if",!0),v.value?(u(),m("div",{key:1,class:A(s(l).e("wrapper"))},[z(e.$slots,"placeholder",{},()=>[K("div",{class:A(s(l).e("placeholder"))},null,2)])],2)):w("v-if",!0)],64)),s(I)?(u(),m(V,{key:2},[E.value?(u(),D(s(Le),{key:0,"z-index":e.zIndex,"initial-index":s(X),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:Q,onSwitch:ee},{default:fe(()=>[e.$slots.viewer?(u(),m("div",{key:0},[z(e.$slots,"viewer")])):w("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):w("v-if",!0)],64)):w("v-if",!0)],16))}});var Ae=ve(ze,[["__file","image.vue"]]);const Be=we(Ae),Te=N({__name:"HairyImage",props:F,setup(r){const n=r,t=he("HairyImageGroup:preview",void 0);return(a,d)=>(u(),D(s(Be),B(n,{class:["HairyImage",[s(t)&&"cursor-pointer rounded"]],onClick:d[0]||(d[0]=l=>{var f;return(f=s(t))==null?void 0:f(a.src)})}),null,16,["class"]))}});export{Te as _};
