import{at as ke,au as j,av as he,E as Ie,G as re,H as xe,I as ie,d as ve,aw as oe,ax as we,ay as ye,J as Te,K as Ce,az as Ee,M,aA as Ne,aB as Oe,i as L,O as le,T as ze,P as Le,b as V,e as ce,w as I,j as f,al as Se,g as x,Q as g,f as n,y as ue,as as Re,x as Y,ac as O,ar as Me,c as U,F as fe,aC as Ae,aD as $e,aE as Xe,aF as Be,ab as Fe,aG as Ve,aH as Ye,k as De,aI as Pe,aJ as We,r as He,aK as je,S as Ke,X as H,aL as A,Y as Ge}from"./app-JCmIxXXV.js";var Je=/\s/;function Ue(e){for(var r=e.length;r--&&Je.test(e.charAt(r)););return r}var Ze=/^\s+/;function Qe(e){return e&&e.slice(0,Ue(e)+1).replace(Ze,"")}var de=NaN,qe=/^[-+]0x[0-9a-f]+$/i,ea=/^0b[01]+$/i,aa=/^0o[0-7]+$/i,na=parseInt;function me(e){if(typeof e=="number")return e;if(ke(e))return de;if(j(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=j(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=Qe(e);var l=ea.test(e);return l||aa.test(e)?na(e.slice(2),l?2:8):qe.test(e)?de:+e}var Z=function(){return he.Date.now()},ta="Expected a function",sa=Math.max,ra=Math.min;function ia(e,r,l){var d,s,p,C,t,w,y=0,$=!1,E=!1,b=!0;if(typeof e!="function")throw new TypeError(ta);r=me(r)||0,j(l)&&($=!!l.leading,E="maxWait"in l,p=E?sa(me(l.maxWait)||0,r):p,b="trailing"in l?!!l.trailing:b);function m(i){var _=d,T=s;return d=s=void 0,y=i,C=e.apply(T,_),C}function S(i){return y=i,t=setTimeout(R,r),$?m(i):C}function c(i){var _=i-w,T=i-y,W=r-_;return E?ra(W,p-T):W}function D(i){var _=i-w,T=i-y;return w===void 0||_>=r||_<0||E&&T>=p}function R(){var i=Z();if(D(i))return X(i);t=setTimeout(R,c(i))}function X(i){return t=void 0,b&&d?m(i):(d=s=void 0,C)}function P(){t!==void 0&&clearTimeout(t),y=0,d=w=s=t=void 0}function K(){return t===void 0?C:X(Z())}function B(){var i=Z(),_=D(i);if(d=arguments,s=this,w=i,_){if(t===void 0)return S(w);if(E)return clearTimeout(t),t=setTimeout(R,r),m(w)}return t===void 0&&(t=setTimeout(R,r)),C}return B.cancel=P,B.flush=K,B}var oa="Expected a function";function Q(e,r,l){var d=!0,s=!0;if(typeof e!="function")throw new TypeError(oa);return j(l)&&(d="leading"in l?!!l.leading:d,s="trailing"in l?!!l.trailing:s),ia(e,r,{leading:d,maxWait:r,trailing:s})}const la=e=>Object.keys(e),ca=Ie({urlList:{type:re(Array),default:()=>xe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:re(String)}}),ua={close:()=>!0,switch:e=>ie(e),rotate:e=>ie(e)},fa=ve({name:"ElImageViewer"}),da=ve({...fa,props:ca,emits:ua,setup(e,{expose:r,emit:l}){var d;const s=e,p={CONTAIN:{name:"contain",icon:oe(we)},ORIGINAL:{name:"original",icon:oe(ye)}},{t:C}=Te(),t=Ce("image-viewer"),{nextZIndex:w}=Ee(),y=M(),$=M([]),E=Ne(),b=M(!0),m=M(s.initialIndex),S=Oe(p.CONTAIN),c=M({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),D=M((d=s.zIndex)!=null?d:w()),R=L(()=>{const{urlList:a}=s;return a.length<=1}),X=L(()=>m.value===0),P=L(()=>m.value===s.urlList.length-1),K=L(()=>s.urlList[m.value]),B=L(()=>[t.e("btn"),t.e("prev"),t.is("disabled",!s.infinite&&X.value)]),i=L(()=>[t.e("btn"),t.e("next"),t.is("disabled",!s.infinite&&P.value)]),_=L(()=>{const{scale:a,deg:u,offsetX:o,offsetY:v,enableTransition:k}=c.value;let h=o/a,N=v/a;const F=u*Math.PI/180,te=Math.cos(F),se=Math.sin(F);h=h*te+N*se,N=N*te-o/a*se;const J={transform:`scale(${a}) rotate(${u}deg) translate(${h}px, ${N}px)`,transition:k?"transform .3s":""};return S.value.name===p.CONTAIN.name&&(J.maxWidth=J.maxHeight="100%"),J});function T(){ge(),l("close")}function W(){const a=Q(o=>{switch(o.code){case A.esc:s.closeOnPressEscape&&T();break;case A.space:ee();break;case A.left:ae();break;case A.up:z("zoomIn");break;case A.right:ne();break;case A.down:z("zoomOut");break}}),u=Q(o=>{const v=o.deltaY||o.deltaX;z(v<0?"zoomIn":"zoomOut",{zoomRate:s.zoomRate,enableTransition:!1})});E.run(()=>{H(document,"keydown",a),H(document,"wheel",u)})}function ge(){E.stop()}function pe(){b.value=!1}function be(a){b.value=!1,a.target.alt=C("el.image.error")}function _e(a){if(b.value||a.button!==0||!y.value)return;c.value.enableTransition=!1;const{offsetX:u,offsetY:o}=c.value,v=a.pageX,k=a.pageY,h=Q(F=>{c.value={...c.value,offsetX:u+F.pageX-v,offsetY:o+F.pageY-k}}),N=H(document,"mousemove",h);H(document,"mouseup",()=>{N()}),a.preventDefault()}function q(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ee(){if(b.value)return;const a=la(p),u=Object.values(p),o=S.value.name,k=(u.findIndex(h=>h.name===o)+1)%a.length;S.value=p[a[k]],q()}function G(a){const u=s.urlList.length;m.value=(a+u)%u}function ae(){X.value&&!s.infinite||G(m.value-1)}function ne(){P.value&&!s.infinite||G(m.value+1)}function z(a,u={}){if(b.value)return;const{minScale:o,maxScale:v}=s,{zoomRate:k,rotateDeg:h,enableTransition:N}={zoomRate:s.zoomRate,rotateDeg:90,enableTransition:!0,...u};switch(a){case"zoomOut":c.value.scale>o&&(c.value.scale=Number.parseFloat((c.value.scale/k).toFixed(3)));break;case"zoomIn":c.value.scale<v&&(c.value.scale=Number.parseFloat((c.value.scale*k).toFixed(3)));break;case"clockwise":c.value.deg+=h,l("rotate",c.value.deg);break;case"anticlockwise":c.value.deg-=h,l("rotate",c.value.deg);break}c.value.enableTransition=N}return le(K,()=>{ze(()=>{const a=$.value[0];a!=null&&a.complete||(b.value=!0)})}),le(m,a=>{q(),l("switch",a)}),Le(()=>{var a,u;W(),(u=(a=y.value)==null?void 0:a.focus)==null||u.call(a)}),r({setActiveItem:G}),(a,u)=>(V(),ce(n(je),{to:"body",disabled:!a.teleported},{default:I(()=>[f(Se,{name:"viewer-fade",appear:""},{default:I(()=>[x("div",{ref_key:"wrapper",ref:y,tabindex:-1,class:g(n(t).e("wrapper")),style:ue({zIndex:D.value})},[x("div",{class:g(n(t).e("mask")),onClick:Re(o=>a.hideOnClickModal&&T(),["self"])},null,10,["onClick"]),Y(" CLOSE "),x("span",{class:g([n(t).e("btn"),n(t).e("close")]),onClick:T},[f(n(O),null,{default:I(()=>[f(n(Me))]),_:1})],2),Y(" ARROW "),n(R)?Y("v-if",!0):(V(),U(fe,{key:0},[x("span",{class:g(n(B)),onClick:ae},[f(n(O),null,{default:I(()=>[f(n(Ae))]),_:1})],2),x("span",{class:g(n(i)),onClick:ne},[f(n(O),null,{default:I(()=>[f(n($e))]),_:1})],2)],64)),Y(" ACTIONS "),x("div",{class:g([n(t).e("btn"),n(t).e("actions")])},[x("div",{class:g(n(t).e("actions__inner"))},[f(n(O),{onClick:o=>z("zoomOut")},{default:I(()=>[f(n(Xe))]),_:1},8,["onClick"]),f(n(O),{onClick:o=>z("zoomIn")},{default:I(()=>[f(n(Be))]),_:1},8,["onClick"]),x("i",{class:g(n(t).e("actions__divider"))},null,2),f(n(O),{onClick:ee},{default:I(()=>[(V(),ce(Fe(n(S).icon)))]),_:1}),x("i",{class:g(n(t).e("actions__divider"))},null,2),f(n(O),{onClick:o=>z("anticlockwise")},{default:I(()=>[f(n(Ve))]),_:1},8,["onClick"]),f(n(O),{onClick:o=>z("clockwise")},{default:I(()=>[f(n(Ye))]),_:1},8,["onClick"])],2)],2),Y(" CANVAS "),x("div",{class:g(n(t).e("canvas"))},[(V(!0),U(fe,null,De(a.urlList,(o,v)=>Pe((V(),U("img",{ref_for:!0,ref:k=>$.value[v]=k,key:o,src:o,style:ue(n(_)),class:g(n(t).e("img")),crossorigin:a.crossorigin,onLoad:pe,onError:be,onMousedown:_e},null,46,["src","crossorigin"])),[[We,v===m.value]])),128))],2),He(a.$slots,"default")],6)]),_:3})]),_:3},8,["disabled"]))}});var ma=Ke(da,[["__file","image-viewer.vue"]]);const ga=Ge(ma);export{ga as E,ca as i};
